var documenterSearchIndex = {"docs":
[{"location":"functions/#Functions","page":"Functions","title":"Functions","text":"","category":"section"},{"location":"functions/#Methods","page":"Functions","title":"Methods","text":"","category":"section"},{"location":"functions/","page":"Functions","title":"Functions","text":"Modules = [ErrorsInVariablesExtremes]\nPrivate = false\nOrder = [:function]\nPages = [\"src/structures/pseudodata.jl\",\n\t\"src/structures/pseudoensemble.jl\",\n\t\"src/structures/pseudomaximaeva.jl\"\n\t]","category":"page"},{"location":"functions/#Base.convert-Tuple{Type{DataFrames.DataFrame}, Vector{Pseudodata}}","page":"Functions","title":"Base.convert","text":"convert(::Type{DataFrame}, pdata::Vector{Pseudodata})\n\nConvert the vector of Pseudodata type to a DataFrame\n\n\n\n\n\n","category":"method"},{"location":"functions/#Distributions.logpdf-Tuple{Pseudodata, Vector{var\"#s5\"} where var\"#s5\"<:Real}","page":"Functions","title":"Distributions.logpdf","text":"logpdf(pdata::Pseudodata, y::Vector{<:Real})\n\nCompute the log density of each of the potential data y according to the distributions in pdata.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Distributions.logpdf-Tuple{Vector{Pseudodata}, Vector{var\"#s4\"} where var\"#s4\"<:Real}","page":"Functions","title":"Distributions.logpdf","text":"logpdf(pensemble::Pseudoensemble, y::Vector{<:Real})\n\nCompute the logpdf of each of the potential data y according to the distributions in pensemble.\n\nDetails\n\nIndependance is assumed between the members of the pseudoensemble.value, i.e. the sum of the logpdf of each member is taken.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Distributions.pdf-Tuple{Pseudodata, Vector{var\"#s5\"} where var\"#s5\"<:Real}","page":"Functions","title":"Distributions.pdf","text":"pdf(pdata::Pseudodata, y::Vector{<:Real})\n\nCompute the density of each of the potential data y according to the distributions in pdata.\n\n\n\n\n\n","category":"method"},{"location":"functions/#ErrorsInVariablesExtremes.ensemblemean-Tuple{Vector{Pseudodata}}","page":"Functions","title":"ErrorsInVariablesExtremes.ensemblemean","text":"ensemblemean(pdata::Vector{Pseudodata})\n\nCompute the ensemble mean for each year.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Base.convert-Tuple{Type{Extremes.MaximumLikelihoodAbstractExtremeValueModel}, PseudoMaximaEVA, Int64}","page":"Functions","title":"Base.convert","text":"convert(::Type{MaximumLikelihoodEVA}, fm::PseudoMaximaEVA, iter::Int)\n\nConvert a single MCMC iteration of the fm model to a pseudo MaximumLikelihoodEVA for hacking Extremes.jl methods. \n\n\n\n\n\n","category":"method"},{"location":"functions/#Distributions.logpdf-Tuple{PseudoMaximaEVA}","page":"Functions","title":"Distributions.logpdf","text":"function logpdf(fm::PseudoMaximaEVA)\n\nCompute the log density of fm for all MCMC iterations.\n\n\n\n\n\n","category":"method"},{"location":"functions/#ErrorsInVariablesExtremes.dic-Tuple{PseudoMaximaEVA}","page":"Functions","title":"ErrorsInVariablesExtremes.dic","text":"dic(fm::PseudoMaximaEVA)\n\nCompute the Deviance Information Criterion (DIC) described by Gelman et al. (2013) for the PseudoMaximaEVA model fm.\n\nDetails\n\nReference: Gelman, A., Carlin, J.B., Stern, H.S., Dunson, D.B., Vehtari, A. & Rubin, D.B. (2013). Bayesian Data Analysis (3rd ed.). Chapman and Hall/CRC. https://doi.org/10.1201/b16018\n\n\n\n\n\n","category":"method"},{"location":"functions/#Statistics.quantile-Tuple{PseudoMaximaEVA, Real}","page":"Functions","title":"Statistics.quantile","text":"quantile(fm::PseudoMaximaEVA, order::Real)\n\nCompute the effective quantiles or order order for each MCMC iteration of model fm.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Types","page":"Functions","title":"Types","text":"","category":"section"},{"location":"functions/","page":"Functions","title":"Functions","text":"Modules = [ErrorsInVariablesExtremes]\nPrivate = false\nOrder = [:type]","category":"page"},{"location":"functions/#ErrorsInVariablesExtremes.PseudoMaximaEVA","page":"Functions","title":"ErrorsInVariablesExtremes.PseudoMaximaEVA","text":"PseudoMaximaEVA(pseudodata::Pseudoensemble, model::EVA, sim::MambaLite.Chains)\n\nConstruct a PseudoMaximaEVA type.\n\nDetails\n\nEncapsulates the probability distributions for each of the unobserved data for an ensemble of pseudodata, the extreme value model and a sample from the parameters posterior distribution.\n\nTODO: Verify if all member has the same year vector.\n\n\n\n\n\n","category":"type"},{"location":"functions/#ErrorsInVariablesExtremes.PseudoMaximaModel-Tuple{Vector{Pseudodata}}","page":"Functions","title":"ErrorsInVariablesExtremes.PseudoMaximaModel","text":"PseudoMaximaModel(data::Vector{Pseudodata};\n    locationcov::Vector{Variable} = Vector{Variable}(),\n    logscalecov::Vector{Variable} = Vector{Variable}(),\n    shapecov::Vector{Variable} = Vector{Variable}())\n\nCreates a PseudoMaximaModel structure.\n\n\n\n\n\n","category":"method"},{"location":"functions/#ErrorsInVariablesExtremes.Pseudodata","page":"Functions","title":"ErrorsInVariablesExtremes.Pseudodata","text":"Pseudodata(name::String, value::Vector{<:UnivariateDistribution})\n\nConstruct a Pseudodata type.\n\nDetails\n\nEncapsulates the probability distributions for each of the unobserved data. The data are not directly observed but their distributions are known. The distributions can be different for each of the data.\n\n\n\n\n\n","category":"type"},{"location":"tutorial/pseudoensemble/#Pseudoensemble","page":"Pseudoensemble","title":"Pseudoensemble","text":"","category":"section"},{"location":"tutorial/pseudoensemble/","page":"Pseudoensemble","title":"Pseudoensemble","text":"The Pseudoensemble data structure is illustrated using the unobserved riverflows at an ungauged section of the Chaudière River in Québec from 1960 to 2020.","category":"page"},{"location":"tutorial/pseudoensemble/","page":"Pseudoensemble","title":"Pseudoensemble","text":"using ErrorsInVariablesExtremes, Extremes, Dates, DataFrames, Distributions, Gadfly","category":"page"},{"location":"tutorial/pseudoensemble/#Load-the-data","page":"Pseudoensemble","title":"Load the data","text":"","category":"section"},{"location":"tutorial/pseudoensemble/","page":"Pseudoensemble","title":"Pseudoensemble","text":"Loading the pseudo-observations into an object of type Pseudoensemble:","category":"page"},{"location":"tutorial/pseudoensemble/","page":"Pseudoensemble","title":"Pseudoensemble","text":"filename = \"SLSO00003\"\npensemble = ErrorsInVariablesExtremes.load_discharge_distribution(filename)","category":"page"},{"location":"tutorial/pseudoensemble/","page":"Pseudoensemble","title":"Pseudoensemble","text":"The vector of years can be extracted:","category":"page"},{"location":"tutorial/pseudoensemble/","page":"Pseudoensemble","title":"Pseudoensemble","text":"years = pensemble[1].year;","category":"page"},{"location":"tutorial/pseudoensemble/#Convert-to-DataFrame","page":"Pseudoensemble","title":"Convert to DataFrame","text":"","category":"section"},{"location":"tutorial/pseudoensemble/","page":"Pseudoensemble","title":"Pseudoensemble","text":"Converting Pseudoensemble to DataFrame:","category":"page"},{"location":"tutorial/pseudoensemble/","page":"Pseudoensemble","title":"Pseudoensemble","text":"df = convert(DataFrame, pensemble)\nfirst(df,5)","category":"page"},{"location":"tutorial/pseudoensemble/#Extracting-the-statistics","page":"Pseudoensemble","title":"Extracting the statistics","text":"","category":"section"},{"location":"tutorial/pseudoensemble/","page":"Pseudoensemble","title":"Pseudoensemble","text":"# Interval confidence level\nα = 0.5\n\n# Median\ndf[:, :y] = median.(df.Distribution)\n\n# Lower bound of the confidence interval\ndf[:, :ymin] = quantile.(df.Distribution, α/2)\n\n# Upper bound of the confidence interval\ndf[:, :ymax] = quantile.(df.Distribution, 1-α/2)\n\nfirst(df, 5)","category":"page"},{"location":"tutorial/pseudoensemble/#Display-the-discharge-of-one-specific-configuration","page":"Pseudoensemble","title":"Display the discharge of one specific configuration","text":"","category":"section"},{"location":"tutorial/pseudoensemble/","page":"Pseudoensemble","title":"Pseudoensemble","text":"config = \"LN24HA\"\ndf2 = filter(row -> row.Configuration ==config, df)\n\nset_default_plot_size(12cm, 8cm)\nplot(df2, x=:Year, y=:y, Geom.line, Geom.point,\n    ymin=:ymin, ymax=:ymax, Geom.ribbon,\n    Guide.ylabel(\"Discharge [m³/s]\"),\n    Guide.title(config))","category":"page"},{"location":"tutorial/pseudoensemble/#Display-the-discharge-of-all-configurations","page":"Pseudoensemble","title":"Display the discharge of all configurations","text":"","category":"section"},{"location":"tutorial/pseudoensemble/","page":"Pseudoensemble","title":"Pseudoensemble","text":"set_default_plot_size(12cm, 8cm)\nfig = plot(df, x=:Year, y=:y, color=:Configuration, Geom.line,\n    ymin=:ymin, ymax=:ymax, Geom.ribbon,\n    Guide.ylabel(\"Discharge [m³/s]\"))","category":"page"},{"location":"tutorial/analysis/#Bayesian-analysis-of-the-estimated-discharges","page":"Analysis of estimated discharges","title":"Bayesian analysis of the estimated discharges","text":"","category":"section"},{"location":"tutorial/analysis/","page":"Analysis of estimated discharges","title":"Analysis of estimated discharges","text":"using ErrorsInVariablesExtremes, Extremes, Dates, DataFrames, Distributions, Gadfly, Cairo, Fontconfig","category":"page"},{"location":"tutorial/analysis/#Load-the-data","page":"Analysis of estimated discharges","title":"Load the data","text":"","category":"section"},{"location":"tutorial/analysis/","page":"Analysis of estimated discharges","title":"Analysis of estimated discharges","text":"Loading the pseudo-observations into an object of type Pseudoensemble:","category":"page"},{"location":"tutorial/analysis/","page":"Analysis of estimated discharges","title":"Analysis of estimated discharges","text":"filename = \"SLSO00003\"\npdata = ErrorsInVariablesExtremes.load_discharge_distribution(filename)","category":"page"},{"location":"tutorial/analysis/","page":"Analysis of estimated discharges","title":"Analysis of estimated discharges","text":"Converting in DataFrame:","category":"page"},{"location":"tutorial/analysis/","page":"Analysis of estimated discharges","title":"Analysis of estimated discharges","text":"df = convert(DataFrame, pdata)\nfirst(df,5)","category":"page"},{"location":"tutorial/analysis/#Combination-of-the-hydrological-configurations-for-the-log-discharges","page":"Analysis of estimated discharges","title":"Combination of the hydrological configurations for the log-discharges","text":"","category":"section"},{"location":"tutorial/analysis/","page":"Analysis of estimated discharges","title":"Analysis of estimated discharges","text":"See Eq. (11) and (12) of the paper.","category":"page"},{"location":"tutorial/analysis/","page":"Analysis of estimated discharges","title":"Analysis of estimated discharges","text":"df[:,:η] = first.(params.(df.Distribution))\ndf[:,:ζ] = last.(params.(df.Distribution))\n\nm = Float64[]\ns = Float64[]\n\nfor iYear in unique(df.Year)\n\n    df3 = filter(row -> row.Year==iYear, df)\n    mᵢ = sum(df3.η ./ df3.ζ.^2) / sum( 1 ./df3.ζ.^2)\n    sᵢ = sqrt(1/sum( 1 ./df3.ζ.^2))\n        \n    push!(m, mᵢ)\n    push!(s, sᵢ)\n        \nend\n\npdata[1].year\n\ndatadist = Pseudodata(\"Combined\",pdata[1].year ,Normal.(m, s))","category":"page"},{"location":"tutorial/analysis/#Stationary-model","page":"Analysis of estimated discharges","title":"Stationary model","text":"","category":"section"},{"location":"tutorial/analysis/#Specifying-the-stationary-extreme-value-Bayesian-model","page":"Analysis of estimated discharges","title":"Specifying the stationary extreme value Bayesian model","text":"","category":"section"},{"location":"tutorial/analysis/","page":"Analysis of estimated discharges","title":"Analysis of estimated discharges","text":"The stationary model used the combined estimates of discharges and a semi-informative prior.","category":"page"},{"location":"tutorial/analysis/","page":"Analysis of estimated discharges","title":"Analysis of estimated discharges","text":"model1 = PseudoMaximaModel([datadist], prior=[Flat(), Flat(), LocationScale(-.5, 1, Beta(6,9))])","category":"page"},{"location":"tutorial/analysis/#MCMC","page":"Analysis of estimated discharges","title":"MCMC","text":"","category":"section"},{"location":"tutorial/analysis/","page":"Analysis of estimated discharges","title":"Analysis of estimated discharges","text":"fm1 = fitbayes(model1, niter=20000, warmup=10001, thin=10, δₒ = .5)","category":"page"},{"location":"tutorial/analysis/#Traces-of-the-parameters","page":"Analysis of estimated discharges","title":"Traces of the parameters","text":"","category":"section"},{"location":"tutorial/analysis/","page":"Analysis of estimated discharges","title":"Analysis of estimated discharges","text":"Trace of the GEV parameters:","category":"page"},{"location":"tutorial/analysis/","page":"Analysis of estimated discharges","title":"Analysis of estimated discharges","text":"fig1 = plot(y=fm1.parameters.value[:,1], Geom.line,\n    Guide.xlabel(\"Iteration\"), Guide.ylabel(\"μ\"));\n\nfig2 = plot(y=exp.(fm1.parameters.value[:,2]), Geom.line,\n    Guide.xlabel(\"Iteration\"), Guide.ylabel(\"σ\"));\n\nfig3 = plot(y=fm1.parameters.value[:,3], Geom.line,\n    Guide.xlabel(\"Iteration\"), Guide.ylabel(\"ξ\"));\n\nset_default_plot_size(24cm, 12cm)\ngridstack([fig1 fig2;\n    fig3 Gadfly.plot()])","category":"page"},{"location":"tutorial/analysis/#Non-stationary-model","page":"Analysis of estimated discharges","title":"Non-stationary model","text":"","category":"section"},{"location":"tutorial/analysis/#Specifying-the-non-stationary-extreme-value-Bayesian-model","page":"Analysis of estimated discharges","title":"Specifying the non-stationary extreme value Bayesian model","text":"","category":"section"},{"location":"tutorial/analysis/","page":"Analysis of estimated discharges","title":"Analysis of estimated discharges","text":"The non-stationary model used the combined estimates of discharges and a semi-informative prior. The GEV location parameter is function of the year.","category":"page"},{"location":"tutorial/analysis/","page":"Analysis of estimated discharges","title":"Analysis of estimated discharges","text":"t = collect(0:59)\n\ncovariate = Variable(\"t\", t );\n\nmodel2 = PseudoMaximaModel([datadist], locationcov = [covariate], \n    prior=[Flat(), Flat(), Flat(),  LocationScale(-.5, 1, Beta(6,9))])","category":"page"},{"location":"tutorial/analysis/#MCMC-2","page":"Analysis of estimated discharges","title":"MCMC","text":"","category":"section"},{"location":"tutorial/analysis/","page":"Analysis of estimated discharges","title":"Analysis of estimated discharges","text":"fm2 = fitbayes(model2, niter=20000, warmup=10001, thin=10, δₒ = .5);","category":"page"},{"location":"tutorial/analysis/#Traces-of-the-parameters-2","page":"Analysis of estimated discharges","title":"Traces of the parameters","text":"","category":"section"},{"location":"tutorial/analysis/","page":"Analysis of estimated discharges","title":"Analysis of estimated discharges","text":"Trace of the GEV parameters:","category":"page"},{"location":"tutorial/analysis/","page":"Analysis of estimated discharges","title":"Analysis of estimated discharges","text":"fig1 = plot(y=fm2.parameters.value[:,1], Geom.line,\n    Guide.xlabel(\"Iteration\"), Guide.ylabel(\"μ<sub>0</sub>\"));\n\nfig2 = plot(y=fm2.parameters.value[:,2], Geom.line,\n    Guide.xlabel(\"Iteration\"), Guide.ylabel(\"μ<sub>1</sub>\"));\n\nfig3 = plot(y=exp.(fm2.parameters.value[:,3]), Geom.line,\n    Guide.xlabel(\"Iteration\"), Guide.ylabel(\"σ\"));\n\nfig4 = plot(y=fm2.parameters.value[:,4], Geom.line,\n    Guide.xlabel(\"Iteration\"), Guide.ylabel(\"ξ\"));\n\nset_default_plot_size(24cm, 12cm)\ngridstack([fig1 fig2;\n    fig3 fig4])","category":"page"},{"location":"tutorial/#Tutorial","page":"Getting started","title":"Tutorial","text":"","category":"section"},{"location":"tutorial/","page":"Getting started","title":"Getting started","text":"This tutorial shows the functionalities of ErrorsInVariablesExtremes.jl. They are illustrated by producing an Extreme Value Analysis of unobserved riverflows at ungauged section of the Chaudière River.","category":"page"},{"location":"tutorial/","page":"Getting started","title":"Getting started","text":"Before executing this tutorial, make sure to have installed the following packages:","category":"page"},{"location":"tutorial/","page":"Getting started","title":"Getting started","text":"ErrorsInVariablesExtremes.jl (of course)\nExtremes.jl (for more Extreme Value Analysis tools)\nDataFrames.jl (for using the DataFrame type)\nDistributions.jl (for using probability distribution objects)\nGadfly.jl (for plotting)\nCSV.jl (to load CSV files)","category":"page"},{"location":"tutorial/","page":"Getting started","title":"Getting started","text":"and import them using the following command:","category":"page"},{"location":"tutorial/","page":"Getting started","title":"Getting started","text":"using ErrorsInVariablesExtremes, Extremes, Dates, DataFrames, Distributions, Gadfly, CSV","category":"page"},{"location":"#Extreme-value-analysis-for-error-in-variables-models.","page":"Extreme value analysis for error in variables models.","title":"Extreme value analysis for error in variables models.","text":"","category":"section"}]
}
