var documenterSearchIndex = {"docs":
[{"location":"functions/#Functions","page":"Functions","title":"Functions","text":"","category":"section"},{"location":"functions/#Methods-for-Pseudodata","page":"Functions","title":"Methods for Pseudodata","text":"","category":"section"},{"location":"functions/","page":"Functions","title":"Functions","text":"convert(::Type{DataFrame}, ::Vector{Pseudodata})\nensemblemean(::Vector{Pseudodata})","category":"page"},{"location":"functions/#Base.convert-Tuple{Type{DataFrame}, Vector{Pseudodata}}","page":"Functions","title":"Base.convert","text":"convert(::Type{DataFrame}, pdata::Vector{Pseudodata})\n\nConvert the vector of Pseudodata type to a DataFrame\n\n\n\n\n\n","category":"method"},{"location":"functions/#ErrorsInVariablesExtremes.ensemblemean-Tuple{Vector{Pseudodata}}","page":"Functions","title":"ErrorsInVariablesExtremes.ensemblemean","text":"ensemblemean(pdata::Vector{Pseudodata})\n\nCompute the ensemble mean for each year.\n\n\n\n\n\n","category":"method"},{"location":"functions/#Parameter-estimation","page":"Functions","title":"Parameter estimation","text":"","category":"section"},{"location":"functions/","page":"Functions","title":"Functions","text":"fitbayes","category":"page"},{"location":"functions/#Extremes.fitbayes","page":"Functions","title":"Extremes.fitbayes","text":"fitbayes(model::EVA; niter::Int=5000, warmup::Int=2000)::BayesianEVA\n\nFit the extreme value model under the Bayesian paradigm.\n\n\n\n\n\n","category":"function"},{"location":"functions/#Methods-for-fitted-models","page":"Functions","title":"Methods for fitted models","text":"","category":"section"},{"location":"functions/","page":"Functions","title":"Functions","text":"convert(::Type{MaximumLikelihoodEVA}, ::PseudoMaximaEVA, ::Int)\ndic","category":"page"},{"location":"functions/#Base.convert-Tuple{Type{MaximumLikelihoodEVA}, PseudoMaximaEVA, Int64}","page":"Functions","title":"Base.convert","text":"convert(::Type{MaximumLikelihoodEVA}, fm::PseudoMaximaEVA, iter::Int)\n\nConvert a single MCMC iteration of the fm model to a pseudo MaximumLikelihoodEVA for hacking Extremes.jl methods. \n\n\n\n\n\n","category":"method"},{"location":"functions/#ErrorsInVariablesExtremes.dic","page":"Functions","title":"ErrorsInVariablesExtremes.dic","text":"dic(fm::PseudoMaximaEVA)\n\nCompute the Deviance Information Criterion (DIC) described by Gelman et al. (2013) for the PseudoMaximaEVA model fm.\n\nDetails\n\nReference: Gelman, A., Carlin, J.B., Stern, H.S., Dunson, D.B., Vehtari, A. & Rubin, D.B. (2013). Bayesian Data Analysis (3rd ed.). Chapman and Hall/CRC. https://doi.org/10.1201/b16018\n\n\n\n\n\n","category":"function"},{"location":"functions/#Diagnostic-plots","page":"Functions","title":"Diagnostic plots","text":"","category":"section"},{"location":"functions/","page":"Functions","title":"Functions","text":"diagnosticplots\nhistplot\nprobplot\nqqplot\nreturnlevelplot","category":"page"},{"location":"functions/#Extremes.diagnosticplots","page":"Functions","title":"Extremes.diagnosticplots","text":"diagnosticplots(fm::fittedEVA)\n\nDiagnostic plots\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.histplot","page":"Functions","title":"Extremes.histplot","text":"histplot(fm::fittedEVA)\n\nHistogram plot\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.probplot","page":"Functions","title":"Extremes.probplot","text":"probplot(fm::fittedEVA)\n\nProbability plot\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.qqplot","page":"Functions","title":"Extremes.qqplot","text":"qqplot(fm::fittedEVA)\n\nQuantile-Quantile plot\n\n\n\n\n\n","category":"function"},{"location":"functions/#Extremes.returnlevelplot","page":"Functions","title":"Extremes.returnlevelplot","text":"returnlevelplot(fm::fittedEVA)\n\nReturn level plot\n\n\n\n\n\n","category":"function"},{"location":"functions/#Types","page":"Functions","title":"Types","text":"","category":"section"},{"location":"functions/","page":"Functions","title":"Functions","text":"Modules = [ErrorsInVariablesExtremes]\nPrivate = false\nOrder = [:type]","category":"page"},{"location":"functions/#ErrorsInVariablesExtremes.PseudoMaximaEVA","page":"Functions","title":"ErrorsInVariablesExtremes.PseudoMaximaEVA","text":"PseudoMaximaEVA(pseudodata::Pseudoensemble, model::EVA, sim::MambaLite.Chains)\n\nConstruct a PseudoMaximaEVA type.\n\nDetails\n\nEncapsulates the probability distributions for each of the unobserved data for an ensemble of pseudodata, the extreme value model and a sample from the parameters posterior distribution.\n\nTODO: Verify if all member has the same year vector.\n\n\n\n\n\n","category":"type"},{"location":"functions/#ErrorsInVariablesExtremes.PseudoMaximaModel-Tuple{Vector{Pseudodata}}","page":"Functions","title":"ErrorsInVariablesExtremes.PseudoMaximaModel","text":"PseudoMaximaModel(data::Vector{Pseudodata};\n    locationcov::Vector{Variable} = Vector{Variable}(),\n    logscalecov::Vector{Variable} = Vector{Variable}(),\n    shapecov::Vector{Variable} = Vector{Variable}())\n\nCreates a PseudoMaximaModel structure.\n\n\n\n\n\n","category":"method"},{"location":"functions/#ErrorsInVariablesExtremes.Pseudodata","page":"Functions","title":"ErrorsInVariablesExtremes.Pseudodata","text":"Pseudodata(name::String, value::Vector{<:UnivariateDistribution})\n\nConstruct a Pseudodata type.\n\nDetails\n\nEncapsulates the probability distributions for each of the unobserved data. The data are not directly observed but their distributions are known. The distributions can be different for each of the data.\n\n\n\n\n\n","category":"type"},{"location":"tutorial/riverflows/#Unobserved-riverflows-in-Québec,-Canada","page":"Unobserved riverflows analysis","title":"Unobserved riverflows in Québec, Canada","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"The functionalities of ErrorsInVariablesExtremes.jl are illustrated by producing an Extreme Value Analysis of unobserved riverflows of a section of the Chaudière River in Québec, Canada, from 1960 to 2020.","category":"page"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"using ErrorsInVariablesExtremes, Extremes, DataFrames, CSV, Distributions, Mamba, Gadfly, Cairo, Fontconfig","category":"page"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"","category":"page"},{"location":"tutorial/riverflows/#Load-the-data","page":"Unobserved riverflows analysis","title":"Load the data","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"Loading the pseudo-observations into a vector of Pseudodata:","category":"page"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"filename = \"../../../test/data/A2020_Analyse_Historique_QMA_SLSO00003.nc\"\npdata = load_discharge_distribution(filename)","category":"page"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"The vector of years can be extracted:","category":"page"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"years = pdata[1].year;","category":"page"},{"location":"tutorial/riverflows/#Convert-to-DataFrame","page":"Unobserved riverflows analysis","title":"Convert to DataFrame","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"Converting the vector of Pseudodata to DataFrame:","category":"page"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"df = convert(DataFrame, pdata)\nfirst(df,5)","category":"page"},{"location":"tutorial/riverflows/#Compute-the-median-and-the-1-α-confidence-interval-for-each-of-the-configurations","page":"Unobserved riverflows analysis","title":"Compute the median and the 1-α confidence interval for each of the configurations","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"α = 0.5\n\ndf[:, :y] = median.(df.Distribution)\ndf[:, :ymin] = quantile.(df.Distribution, α/2)\ndf[:, :ymax] = quantile.(df.Distribution, 1-α/2)\n\nfirst(df, 5)","category":"page"},{"location":"tutorial/riverflows/#Display-the-discharge-of-all-configurations","page":"Unobserved riverflows analysis","title":"Display the discharge of all configurations","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"set_default_plot_size(12cm, 8cm)\nplot(df, x=:Year, y=:y, color=:Configuration, Geom.line,\n    ymin=:ymin, ymax=:ymax, Geom.ribbon,\n    Guide.ylabel(\"Discharge [m³/s]\"))","category":"page"},{"location":"tutorial/riverflows/#Display-the-discharge-of-one-specific-configuration","page":"Unobserved riverflows analysis","title":"Display the discharge of one specific configuration","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"config = \"MG24HQ\"\n\ndf2 = filter(row -> row.Configuration ==config, df)\n\nset_default_plot_size(12cm, 8cm)\nplot(df2, x=:Year, y=:y, Geom.line, Geom.point,\n    ymin=:ymin, ymax=:ymax, Geom.ribbon,\n    Guide.ylabel(\"Discharge [m³/s]\"))","category":"page"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"","category":"page"},{"location":"tutorial/riverflows/#Stationary-extreme-value-model","page":"Unobserved riverflows analysis","title":"Stationary extreme value model","text":"","category":"section"},{"location":"tutorial/riverflows/#Statistical-model-definition","page":"Unobserved riverflows analysis","title":"Statistical model definition","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"model1 = PseudoMaximaModel(pdata, prior=[Flat(), Flat(), LocationScale(-.5, 1, Beta(6,9))])","category":"page"},{"location":"tutorial/riverflows/#Sampling-of-the-posterior-distribution-by-MCMC","page":"Unobserved riverflows analysis","title":"Sampling of the posterior distribution by MCMC","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"fm1 = fitbayes(model1)","category":"page"},{"location":"tutorial/riverflows/#Display-of-the-annual-maximum-estimates","page":"Unobserved riverflows analysis","title":"Display of the annual maximum estimates","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"# Compute the estimates\nŷ = vec(mean( fm1.maxima[:, :, 1].value, dims=1))\n\n# Compute the 95% credible interval\nymin = [quantile(vec(fm1.maxima[:, j, 1].value), .025) for j in 1:length(ŷ)]\nymax= [quantile(vec(fm1.maxima[:, j, 1].value), .975) for j in 1:length(ŷ)]\n\ndf = DataFrame(Year = years, Discharge=ŷ, ymin = ymin, ymax=ymax)\n\n# Plot the ponctual estimates and the intervals\nset_default_plot_size(12cm, 8cm)\nplot(df, x=:Year, y=:Discharge, Geom.line, Geom.point,\n    ymin=ymin, ymax=ymax, Geom.ribbon\n)","category":"page"},{"location":"tutorial/riverflows/#Fit-of-the-GEV-law-adjusted-to-the-estimates-of-the-annual-maxima","page":"Unobserved riverflows analysis","title":"Fit of the GEV law adjusted to the estimates of the annual maxima","text":"","category":"section"},{"location":"tutorial/riverflows/#General-fit-with-residuals","page":"Unobserved riverflows analysis","title":"General fit with residuals","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"set_default_plot_size(21cm ,16cm)\ndiagnosticplots(fm1, step = 20)","category":"page"},{"location":"tutorial/riverflows/#Fit-for-a-single-MCMC-iteration","page":"Unobserved riverflows analysis","title":"Fit for a single MCMC iteration","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"set_default_plot_size(21cm ,16cm)\nErrorsInVariablesExtremes.diagnosticplots_iter(fm1, 200)","category":"page"},{"location":"tutorial/riverflows/#Quantile-estimation","page":"Unobserved riverflows analysis","title":"Quantile estimation","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"# Return period\nT = 20\n\nr = vec(quantile(fm1, 1-1/T))\n\nset_default_plot_size(12cm, 8cm)\nplot(x=r, Geom.density,\n    Guide.xlabel(string(T,\"-year return level [m³/s]\")), Guide.ylabel(\"Density\"))","category":"page"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"","category":"page"},{"location":"tutorial/riverflows/#Non-stationary-extreme-value-model","page":"Unobserved riverflows analysis","title":"Non stationary extreme value model","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"The location parameter of the GEV law is a function of the GHG concentration in the atmosphere.","category":"page"},{"location":"tutorial/riverflows/#Loading-the-covariable","page":"Unobserved riverflows analysis","title":"Loading the covariable","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"co2data = CSV.read(\"../../../test/data/RCPdata.csv\", DataFrame);\nfilter!(row->row.Year in pdata[1].year, co2data)\n\nco2data[:, :RCP85std] = (co2data.RCP85 .- mean(co2data.RCP85)) ./ std(co2data.RCP85)\n\nco2data[:, :t] = (co2data.Year .- mean(co2data.Year)) ./ std(co2data.Year)\n\nlocationcov= Extremes.buildVariables(co2data, [:RCP85std])","category":"page"},{"location":"tutorial/riverflows/#Statistical-model-definition-2","page":"Unobserved riverflows analysis","title":"Statistical model definition","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"model2 = PseudoMaximaModel(pdata, locationcov = locationcov, \n    prior=[Flat(), Flat(), Flat(), LocationScale(-.5, 1, Beta(6,9))])","category":"page"},{"location":"tutorial/riverflows/#Sampling-of-the-posterior-distribution-by-MCMC-2","page":"Unobserved riverflows analysis","title":"Sampling of the posterior distribution by MCMC","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"fm2 = fitbayes(model2)","category":"page"},{"location":"tutorial/riverflows/#Display-of-the-annual-maximum-estimates-2","page":"Unobserved riverflows analysis","title":"Display of the annual maximum estimates","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"# Compute the estimates\nŷ = vec(mean( fm2.maxima[:, :, 1].value, dims=1))\n\n# Compute the 95% credible interval\nymin = [quantile(vec(fm2.maxima[:, j, 1].value), .025) for j in 1:length(ŷ)]\nymax= [quantile(vec(fm2.maxima[:, j, 1].value), .975) for j in 1:length(ŷ)]\n\ndf = DataFrame(Year = years, Discharge=ŷ, ymin = ymin, ymax=ymax)\n\n# Plot the ponctual estimates and the intervals\nset_default_plot_size(12cm, 8cm)\nplot(df, x=:Year, y=:Discharge, Geom.line, Geom.point,\n    ymin=ymin, ymax=ymax, Geom.ribbon\n)","category":"page"},{"location":"tutorial/riverflows/#Fit-of-the-GEV-law-adjusted-to-the-estimates-of-the-annual-maxima-2","page":"Unobserved riverflows analysis","title":"Fit of the GEV law adjusted to the estimates of the annual maxima","text":"","category":"section"},{"location":"tutorial/riverflows/#General-fit-with-residuals-2","page":"Unobserved riverflows analysis","title":"General fit with residuals","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"set_default_plot_size(21cm ,16cm)\ndiagnosticplots(fm2, step = 20)","category":"page"},{"location":"tutorial/riverflows/#Fit-for-a-single-MCMC-iteration-2","page":"Unobserved riverflows analysis","title":"Fit for a single MCMC iteration","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"set_default_plot_size(21cm ,16cm)\nErrorsInVariablesExtremes.diagnosticplots_iter(fm2, 200)","category":"page"},{"location":"tutorial/riverflows/#Quantile-estimation-2","page":"Unobserved riverflows analysis","title":"Quantile estimation","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"# Return period\nT = 20\n\nr = quantile(fm2, 1-1/T)\n\ndf = DataFrame(Iteration = 1:size(r,1))\n\ncolnames = string.(pdata[1].year)\n\nfor j in 1:size(r,2)\n   \n    df[:, colnames[j]] = r[:,j]\n    \nend\n\nlongdf = stack(df, Not(:Iteration))\nrename!(longdf, :variable => :Year )\nlongdf[!,:Year] = parse.(Int,longdf.Year)\n\n\ndf_quantile = combine(groupby(longdf, :Year),\n                :value => (x -> quantile(x, .025)) => :ymin,\n                :value => mean => :ȳ,\n                :value => (x -> quantile(x, .975)) => :ymax)\n\nset_default_plot_size(12cm, 8cm)\nplot(df_quantile, x=:Year, y=:ȳ, Geom.line,\n    ymin=:ymin, ymax=:ymax, Geom.ribbon,\n    Guide.ylabel(string(T,\"-year return level [m³/s]\")))","category":"page"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"","category":"page"},{"location":"tutorial/riverflows/#Model-selection","page":"Unobserved riverflows analysis","title":"Model selection","text":"","category":"section"},{"location":"tutorial/riverflows/","page":"Unobserved riverflows analysis","title":"Unobserved riverflows analysis","text":"res = dic.([fm1, fm2])\nargmin(res)","category":"page"},{"location":"tutorial/#Tutorial","page":"Getting started","title":"Tutorial","text":"","category":"section"},{"location":"tutorial/","page":"Getting started","title":"Getting started","text":"This tutorial shows the functionalities of ErrorsInVariablesExtremes.jl. They are illustrated by producing an Extreme Value Analysis of unobserved riverflows of a section of the Chaudière River in Québec, Canada.","category":"page"},{"location":"tutorial/","page":"Getting started","title":"Getting started","text":"Before executing this tutorial, make sure to have installed the following packages:","category":"page"},{"location":"tutorial/","page":"Getting started","title":"Getting started","text":"ErrorsInVariablesExtremes.jl \nExtremes.jl (for more Extreme Value Analysis tools)\nDataFrames.jl (for using the DataFrame type)\nCSV.jl (to load CSV files)\nDistributions.jl (for using probability distribution objects)\nMamba.jl (for more MCMC tools)\nGadfly.jl (for plotting)","category":"page"},{"location":"tutorial/","page":"Getting started","title":"Getting started","text":"and import them using the following command:","category":"page"},{"location":"tutorial/","page":"Getting started","title":"Getting started","text":"using ErrorsInVariablesExtremes, Extremes, DataFrames, CSV, Distributions, Mamba, Gadfly","category":"page"},{"location":"#Extreme-value-analysis-for-errors-in-variables-models","page":"Extreme value analysis for errors-in-variables models","title":"Extreme value analysis for errors-in-variables models","text":"","category":"section"},{"location":"","page":"Extreme value analysis for errors-in-variables models","title":"Extreme value analysis for errors-in-variables models","text":"ErrorsInVariablesExtremes.jl provides exhaustive high-performance functions for the analysis of extreme values in errors-in-variables models in Julia. In particular, methods for pseudodata models are implemented, such as:","category":"page"},{"location":"","page":"Extreme value analysis for errors-in-variables models","title":"Extreme value analysis for errors-in-variables models","text":"Parameter estimation by Bayesian procedure.\nStationary and non-stationary models.\nDiagnostic plots for assessing model accuracy.\nModel selection with deviance information criterion (DIC). ","category":"page"},{"location":"","page":"Extreme value analysis for errors-in-variables models","title":"Extreme value analysis for errors-in-variables models","text":"The Tutorial section illustrates the package functionalities by producing an extreme value analysis of unobserved riverflows for a section of the Chaudière River in Québec, Canada.","category":"page"}]
}
